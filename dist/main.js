(()=>{"use strict";class e{constructor(e,t,{handleCardClick:s}){this.name=e.name,this.src=e.link,this.alt=e.alt,this.templateSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this.templateSelector).content.querySelector(".element").cloneNode(!0)}_handleLikeClick(){this._element.querySelector(".element__heart").classList.toggle("element__heart_active")}_deleteElement(){this._element.remove(),this._element=null}createCard(){return this._element=this._getTemplate(),this._image=this._element.querySelector(".element__image"),this._element.querySelector(".element__title").textContent=this.name,this._image.src=this.src,this._image.alt=this.alt,this._setEventListeners(),this._element}_setEventListeners(){this._element.querySelector(".element__heart").addEventListener("click",(()=>{this._handleLikeClick()})),this._element.querySelector(".element__bucket").addEventListener("click",(()=>{this._deleteElement()})),this._image.addEventListener("click",(()=>{this._handleCardClick(this.name,this.src,this.alt)}))}}const t={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};class s{constructor(e,t){this._form=e,this.selectors=t,this._inputList=Array.from(this._form.querySelectorAll(this.selectors.inputSelector)),this._btn=this._form.querySelector(this.selectors.submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.add(this.selectors.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this.selectors.errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this.selectors.inputErrorClass),t.classList.remove(this.selectors.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}removeInputErrors(){this._inputList.forEach((e=>{this._hideInputError(e),this._toggleButtonState()}))}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._btn.classList.add(this.selectors.inactiveButtonClass),this._btn.setAttribute("disabled",!0)):(this._btn.classList.remove(this.selectors.inactiveButtonClass),this._btn.removeAttribute("disabled"))}_addInputListeners(e){this._checkInputValidity(e),this._toggleButtonState()}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>this._addInputListeners(e)))}))}enableValidation(){this._setEventListeners()}}class r{constructor({popupSelector:e}){this._popupSelector=e,this._popupItem=document.querySelector(this._popupSelector),this._form=this._popupItem.querySelector(".popup__form"),this._setEventListeners()}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleOverlayClose(e){e.target===this._popupItem&&this.close()}_setEventListeners(){this._popupItem.addEventListener("click",(e=>this._handleOverlayClose(e))),window.addEventListener("keydown",(e=>this._handleEscClose(e)))}open(){this._popupItem.classList.add("popup_opened")}close(){this._popupItem.classList.remove("popup_opened")}}class o extends r{constructor({popupSelector:e,handleFormSubmit:t}){super({popupSelector:e}),this.handleFormSubmit=t,this._popupItem=document.querySelector(e),this.setEventListeners()}_getInputValues(){return this._inputList=this._form.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.handleFormSubmit(this._getInputValues())}))}close(){this._form.reset(),super.close()}}const i=document.querySelector(".popup_type_profile"),n=document.querySelector(".popup_type_element"),l=n.querySelector(".popup__form"),a=i.querySelector(".popup__close"),p=i.querySelector(".popup__form"),u=document.querySelector(".profile"),c=u.querySelector(".profile__edit-button"),_=u.querySelector(".profile__add-button"),m="#element-template",h=document.querySelector(".elements"),d=n.querySelector(".popup__close"),S=document.querySelector(".popup_type_for-image").querySelector(".popup__close"),y=new class{constructor({data:e,renderer:t},s){this._initialArray=e,this._renderer=t,this._container=s}renderElements(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.append(e)}addNewItem(e){this._container.prepend(e)}}({data:[{name:"Балаклава",link:"./images/balaklava.jpg",alt:"Балаклавская бухта летом: море и гора"},{name:"Роза-Хутор",link:"./images/rosa-hutor.jpg",alt:"Роза-хутор: вид с вершины Роза-пик зимой, снег и голубое небо"},{name:"Кольский полуостров",link:"./images/kolskiy.jpg",alt:"Кольский полуостров: каменные уступы, рыже-зелёный мох на земле и серое небо"},{name:"Карелия",link:"./images/karelia.jpg",alt:"Волны Белого моря и остров, заросший соснами, вдали"},{name:"Нижний Новгород",link:"./images/Nizhny_Novgorod.jpg",alt:"Прогулочная дорожка вокруг стен нижегородского Кремля на холме"},{name:"Куршская коса",link:"./images/kurshskaya_kosa.jpg",alt:"Куршская Коса: изогнутые сосны и легкий утренний туман"}],renderer:t=>{const s=new e(t,m,{handleCardClick:()=>{E.open(s)}}),r=s.createCard();y.addItem(r)}},h);y.renderElements();const v=new class{constructor(e){this._userNameSelector=e.name,this._userName=document.querySelector(this._userNameSelector).textContent,this._userStatusSelector=e.status,this._userStatus=document.querySelector(this._userStatusSelector).textContent}getUserInfo(){return this._userData={name:document.querySelector(this._userNameSelector).textContent,status:document.querySelector(this._userStatusSelector).textContent},this._userData}setUserInfo(e){document.querySelector(this._userNameSelector).textContent=e.name,document.querySelector(this._userStatusSelector).textContent=e.status}}({name:".profile__name",status:".profile__status"}),E=new class extends r{constructor({popupSelector:e}){super({popupSelector:e}),this._popupItem=document.querySelector(e)}open(e){this._popupItem.querySelector(".popup__image-title").textContent=e.name,this._popupItem.querySelector(".popup__image").src=e.src,this._popupItem.querySelector(".popup__image").alt=e.alt,super.open()}}({popupSelector:".popup_type_for-image"}),g=new o({popupSelector:".popup_type_profile",handleFormSubmit:e=>{v.setUserInfo({name:e.inputProfileName,status:e.inputProfileStatus}),g.close()}}),f=new o({popupSelector:".popup_type_element",handleFormSubmit:t=>{const s=new e({name:t.inputElementTitle,link:t.inputElementImageSrc,alt:t.inputElementTitle},m,{handleCardClick:()=>{E.open(s)}}),r=s.createCard();y.addNewItem(r),f.close()}}),I=new s(p,t);I.enableValidation();const q=new s(l,t);q.enableValidation(),c.addEventListener("click",(()=>{I.removeInputErrors(),v.getUserInfo()&&(document.querySelector(".popup__input_type_profile-name").value=v.getUserInfo().name,document.querySelector(".popup__input_type_profile-status").value=v.getUserInfo().status),g.open()})),a.addEventListener("click",(()=>g.close())),_.addEventListener("click",(()=>{q.removeInputErrors(),f.open()})),d.addEventListener("click",(()=>f.close())),S.addEventListener("click",(()=>E.close()))})();